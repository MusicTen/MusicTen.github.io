# åˆå­¦ Babel å·¥ä½œåŸç†

## å‰è¨€

`Babel` å¯¹äºå‰ç«¯å¼€å‘è€…æ¥è¯´åº”è¯¥æ˜¯å¾ˆç†Ÿæ‚‰äº†ï¼Œæ—¥å¸¸å¼€å‘ä¸­åŸºæœ¬ä¸Šæ˜¯ç¦»ä¸å¼€å®ƒçš„ã€‚

å·²ç»9102äº†ï¼Œæˆ‘ä»¬å·²ç»èƒ½å¤Ÿç†Ÿç»ƒåœ°ä½¿ç”¨ `es2015+` çš„è¯­æ³•ã€‚ä½†æ˜¯å¯¹äºæµè§ˆå™¨æ¥è¯´ï¼Œå¯èƒ½å’Œå®ƒä»¬è¿˜ä¸å¤Ÿç†Ÿæ‚‰ï¼Œæˆ‘ä»¬å¾—è®©æµè§ˆå™¨ç†è§£å®ƒä»¬ï¼Œè¿™å°±éœ€è¦ `Babel`ã€‚

å½“ç„¶ï¼Œä»…ä»…æ˜¯ `Babel` æ˜¯ä¸å¤Ÿçš„ï¼Œè¿˜éœ€è¦ `polyfill` ç­‰ç­‰ï¼Œè¿™é‡Œå°±å…ˆä¸è¯´äº†ã€‚

## Whatï¼šä»€ä¹ˆæ˜¯ `Babel`

> Babel is a toolchain that is mainly used to convert ECMAScript 2015+ code into a backwards compatible version of JavaScript in current and older browsers or environments.

ç®€å•åœ°è¯´ï¼Œ`Babel` èƒ½å¤Ÿè½¬è¯‘ `ECMAScript 2015+` çš„ä»£ç ï¼Œä½¿å®ƒåœ¨æ—§çš„æµè§ˆå™¨ï¼ˆç¯å¢ƒï¼‰ä¸­ä¹Ÿèƒ½å¤Ÿè¿è¡Œã€‚

æˆ‘ä»¬å¯ä»¥åœ¨ <https://babel.docschina.org/repl> å°è¯•ä¸€ä¸‹ã€‚

ä¸€ä¸ªå°ğŸŒ°ï¼š

```javascript
// es2015 çš„ const å’Œ arrow function
const add = (a, b) => a + b;

// Babel è½¬è¯‘å
var add = function add(a, b) {
  return a + b;
};
```

> `Babel` çš„åŠŸèƒ½å¾ˆçº¯ç²¹ã€‚æˆ‘ä»¬ä¼ é€’ä¸€æ®µæºä»£ç ç»™ `Babel`ï¼Œç„¶åå®ƒè¿”å›ä¸€ä¸²æ–°çš„ä»£ç ç»™æˆ‘ä»¬ã€‚å°±æ˜¯è¿™ä¹ˆç®€å•ï¼Œå®ƒä¸ä¼šè¿è¡Œæˆ‘ä»¬çš„ä»£ç ï¼Œä¹Ÿä¸ä¼šå»æ‰“åŒ…æˆ‘ä»¬çš„ä»£ç ã€‚

**å®ƒåªæ˜¯ä¸€ä¸ªç¼–è¯‘å™¨**ã€‚

## How: Babel æ˜¯å¦‚ä½•å·¥ä½œçš„

é¦–å…ˆå¾—è¦å…ˆäº†è§£ä¸€ä¸ªæ¦‚å¿µï¼šæŠ½è±¡è¯­æ³•æ ‘ï¼ˆAbstract Syntax Tree, ASTï¼‰ï¼Œ`Babel` æœ¬è´¨ä¸Šå°±æ˜¯åœ¨æ“ä½œ `AST` æ¥å®Œæˆä»£ç çš„è½¬è¯‘ã€‚

æˆ‘ä»¬è¿˜æ˜¯æ‹¿ä¸Šé¢çš„ğŸŒ°æ¥è¯´æ˜ `const add = (a, b) => a + b;`ï¼Œè¿™æ ·ä¸€å¥ç®€å•çš„ä»£ç ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å®ƒç”Ÿæˆçš„ `AST` ä¼šæ˜¯æ€æ ·çš„ï¼š

```json
{
  "type": "Program",
  "body": [
    {
      "type": "VariableDeclaration", // å˜é‡å£°æ˜
      "declarations": [ // å…·ä½“å£°æ˜
        {
          "type": "VariableDeclarator", // å˜é‡å£°æ˜
          "id": {
            "type": "Identifier", // æ ‡è¯†ç¬¦ï¼ˆæœ€åŸºç¡€çš„ï¼‰
            "name": "add" // å‡½æ•°å
          },
          "init": {
            "type": "ArrowFunctionExpression", // ç®­å¤´å‡½æ•°
            "id": null,
            "expression": true,
            "generator": false,
            "params": [ // å‚æ•°
              {
                "type": "Identifier",
                "name": "a"
              },
              {
                "type": "Identifier",
                "name": "b"
              }
            ],
            "body": { // å‡½æ•°ä½“
              "type": "BinaryExpression", // äºŒé¡¹å¼
              "left": { // äºŒé¡¹å¼å·¦è¾¹
                "type": "Identifier",
                "name": "a"
              },
              "operator": "+", // äºŒé¡¹å¼è¿ç®—ç¬¦
              "right": { // äºŒé¡¹å¼å³è¾¹
                "type": "Identifier",
                "name": "b"
              }
            }
          }
        }
      ],
      "kind": "const"
    }
  ],
  "sourceType": "module"
}
```

### Babel å·¥ä½œè¿‡ç¨‹

äº†è§£äº† `AST` æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œå°±å¯ä»¥å¼€å§‹ç ”ç©¶ `Babel` çš„å·¥ä½œè¿‡ç¨‹äº†ã€‚

ä¸Šé¢è¯´è¿‡ï¼Œ`Babel` çš„åŠŸèƒ½å¾ˆçº¯ç²¹ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªç¼–è¯‘å™¨ã€‚

å¤§å¤šæ•°ç¼–è¯‘å™¨çš„å·¥ä½œè¿‡ç¨‹å¯ä»¥åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼š

1. **Parse(è§£æ)**ï¼šå°†æºä»£ç è½¬æ¢æˆæ›´åŠ æŠ½è±¡çš„è¡¨ç¤ºæ–¹æ³•ï¼ˆä¾‹å¦‚æŠ½è±¡è¯­æ³•æ ‘ï¼‰
2. **Transform(è½¬æ¢)**ï¼šå¯¹ï¼ˆæŠ½è±¡è¯­æ³•æ ‘ï¼‰åšä¸€äº›ç‰¹æ®Šå¤„ç†ï¼Œè®©å®ƒç¬¦åˆç¼–è¯‘å™¨çš„æœŸæœ›
3. **Generate(ä»£ç ç”Ÿæˆ)**ï¼šå°†ç¬¬äºŒæ­¥ç»è¿‡è½¬æ¢è¿‡çš„ï¼ˆæŠ½è±¡è¯­æ³•æ ‘ï¼‰ç”Ÿæˆæ–°çš„ä»£ç 

æ—¢ç„¶ `Babel` æ˜¯ä¸€ä¸ªç¼–è¯‘å™¨ï¼Œå½“ç„¶å®ƒçš„å·¥ä½œè¿‡ç¨‹ä¹Ÿæ˜¯è¿™æ ·çš„ã€‚

